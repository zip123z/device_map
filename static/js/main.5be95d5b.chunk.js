(this.webpackJsonpfloorplan2=this.webpackJsonpfloorplan2||[]).push([[0],{10:function(e,t,a){e.exports=a(25)},18:function(e,t,a){},20:function(e,t,a){},25:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),c=a(9),o=a.n(c),r=(a(18),a(27));a(19),a(20);var s=function(){const[e,t]=Object(n.useState)([]),[a,c]=Object(n.useState)(null),[o,s]=Object(n.useState)([]),[m,i]=Object(n.useState)(null),[d,u]=Object(n.useState)(null),[p,h]=Object(n.useState)({}),[E,b]=Object(n.useState)(!1),[v,g]=Object(n.useState)(!1),[f,j]=Object(n.useState)({subject:"",description:"",contactPerson:"",contactPhone:""}),[N,O]=Object(n.useState)([]),[k,y]=Object(n.useState)(!1),[S,C]=Object(n.useState)([]),[w,x]=Object(n.useState)(!1),[D,q]=Object(n.useState)([]),[I,P]=Object(n.useState)([]),[R,F]=Object(n.useState)("");return Object(n.useEffect)(()=>{r.a.get("http://localhost:5001/api/areas").then(e=>t(e.data)).catch(e=>console.error(e))},[]),Object(n.useEffect)(()=>{if(a){const t=e.find(e=>e.id===parseInt(a));t&&i(t.floorplans[0]||null)}},[e,a]),Object(n.useEffect)(()=>{a&&r.a.get("http://localhost:5001/api/devices/"+a).then(e=>s(e.data)).catch(e=>console.error(e))},[a]),l.a.createElement("div",{className:"App"},l.a.createElement("h1",null,"\u986f\u793a\u5668\u7dad\u8b77\u7cfb\u7d71"),l.a.createElement("div",null,l.a.createElement("label",null,"\u9078\u64c7\u5340\u57df\uff1a"),l.a.createElement("select",{onChange:t=>{const a=t.target.value;c(a),r.a.get("http://localhost:5001/api/devices/"+a).then(e=>s(e.data)).catch(e=>console.error(e));const n=e.find(e=>e.id===parseInt(a));n&&i(n.floorplans[0]||null)}},l.a.createElement("option",{value:""},"\u8acb\u9078\u64c7"),e.map(e=>l.a.createElement("option",{key:e.id,value:e.id},e.name)))),m&&l.a.createElement("div",{style:{width:"100%",marginTop:"20px",position:"relative"}},l.a.createElement("img",{src:m,alt:"Floorplan",style:{width:"100%"}}),o.map(e=>l.a.createElement("div",{key:e.id,style:{position:"absolute",top:100*e.y/662+"%",left:100*e.x/1316+"%",width:"20px",height:"20px",backgroundColor:"red",borderRadius:"50%",transform:"translate(-50%, -50%)",cursor:"pointer"},title:e.type,onClick:()=>(e=>{const t=o.find(t=>t.id===e);u(t),b(!0),r.a.get("http://localhost:5001/api/deviceDetails/"+e).then(e=>{const t=e.data;h(t);const a=t.length;h(e=>({...e,"\u8cc7\u6599":a||"\u5f85\u88dc\u5145"}))}).catch(e=>console.error(e)),r.a.get("http://localhost:5001/api/maintenanceRecords/"+e).then(e=>{const t=e.data;O(t);const a=t.length,n=t.length>0?t.sort((e,t)=>new Date(t.date)-new Date(e.date))[0].date:"\u7121";O(e=>({...e,lastMaintenanceDate:n||"\u7121",maintenanceCount:a||0}))}).catch(e=>console.error(e))})(e.id)}))),E&&d&&l.a.createElement("div",{className:"modal"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("span",{className:"close",onClick:()=>b(!1)},"\xd7"),l.a.createElement("div",{className:"device-info"},l.a.createElement("div",{className:"device-details"},l.a.createElement("h2",null,"\u8a2d\u5099\u57fa\u672c\u8cc7\u8a0a"),Object.entries(p).map(e=>{let[t,a]=e;return l.a.createElement("p",{key:t},l.a.createElement("strong",null,t,"\uff1a"),a)})),l.a.createElement("div",{className:"maintenance-history"},l.a.createElement("h3",null,"\u7dad\u8b77\u6b77\u7a0b\u7d00\u9304"),l.a.createElement("p",null,l.a.createElement("strong",null,"\u6700\u8fd1\u7dad\u8b77\u65e5\u671f\uff1a"),N.lastMaintenanceDate),l.a.createElement("p",null,l.a.createElement("strong",null,"\u7dad\u4fee\u6b21\u6578\uff1a"),l.a.createElement("span",{className:"link",onClick:()=>{r.a.get("http://localhost:5001/api/maintenanceRecords/"+d.id).then(e=>{O(e.data),y(!0)}).catch(e=>console.error(e))}},N.maintenanceCount)),l.a.createElement("button",{onClick:()=>{r.a.get("http://localhost:5001/api/requestTypes").then(e=>{C(e.data),x(!0)}).catch(e=>console.error(e))}},"\u958b\u7acb\u8acb\u6c42\u55ae"))))),w&&l.a.createElement("div",{className:"modal"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("span",{className:"close",onClick:()=>x(!1)},"\xd7"),l.a.createElement("h2",null,"\u9078\u64c7\u8acb\u6c42\u55ae\u985e\u578b"),l.a.createElement("div",null,S.map(e=>l.a.createElement("button",{key:e,className:"link",onClick:()=>(e=>{const t="\u5831\u4fee\u55ae"===e?1:2;r.a.get("http://localhost:5001/api/formFields/"+t).then(t=>{P(t.data),F(e),g(!0)}).catch(e=>console.error(e)),x(!1)})(e)},e))))),k&&l.a.createElement("div",{className:"modal"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("span",{className:"close",onClick:()=>y(!1)},"\xd7"),l.a.createElement("h3",null,"\u76f8\u95dc\u8acb\u6c42\u55ae"),l.a.createElement("div",{className:"maintenance-records"},N.map(e=>l.a.createElement("div",{key:e.id,className:"maintenance-card"},l.a.createElement("p",null,l.a.createElement("strong",null,"\u65e5\u671f\uff1a"),e.date),l.a.createElement("p",null,l.a.createElement("strong",null,"\u63cf\u8ff0\uff1a"),e.description)))))),v&&l.a.createElement("div",{className:"modal"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("span",{className:"close",onClick:()=>g(!1)},"\xd7"),l.a.createElement("h2",null,R)," ",l.a.createElement("form",{onSubmit:e=>{e.preventDefault(),r.a.post("http://localhost:5001/api/submitForm",{deviceId:d.id,formType:R,...f}).then(e=>{alert("\u8acb\u6c42\u55ae\u63d0\u4ea4\u6210\u529f\uff01"),g(!1),j({subject:"",description:"",contactPerson:"",contactPhone:""})}).catch(e=>console.error(e))}},I.map(e=>l.a.createElement("div",{key:e.name},l.a.createElement("label",null,e.label,"\uff1a"),"textarea"===e.type?l.a.createElement("textarea",{value:f[e.name],onChange:t=>j({...f,[e.name]:t.target.value}),required:e.required}):l.a.createElement("input",{type:e.type,value:f[e.name],onChange:t=>j({...f,[e.name]:t.target.value}),required:e.required}))),l.a.createElement("button",{type:"submit"},"\u63d0\u4ea4")))))};o.a.createRoot(document.getElementById("root")).render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(s,null)))}},[[10,1,2]]]);
//# sourceMappingURL=main.5be95d5b.chunk.js.map